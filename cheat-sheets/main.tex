\documentclass{article}
\usepackage[a6paper, top=0.75in, bottom=0.75in, left=0.2in, right=0.2in]{geometry}
\usepackage{graphicx}
\usepackage{qrcode}
\usepackage{fontspec}
\usepackage{datatool}
\usepackage{fancyhdr}

\newfontfamily\ProximaNova{fonts/ProximaNova}[
  UprightFont = *Regular ,
  ItalicFont = *RegularItalic ,
  BoldFont = *Bold ,
  BoldItalicFont = * BoldItalic ,
  FontFace = {l}{n}{*Light},
  FontFace = {l}{it}{*LightItalic},
  FontFace = {sb}{n}{*Semibold},
  FontFace = {sb}{it}{*SemiboldItalic},
  FontFace = {eb}{n}{*Black},
  FontFace = {eb}{it}{*BlackItalic},
  Extension = .otf ]

\setmainfont{ProximaNova}

% Define logos
\newcommand{\leftlogo}{\includegraphics[height=1cm]{../docs/assets/uos-logo-black.png}}
\newcommand{\rightlogo}{\includegraphics[height=1cm]{../docs/assets/uos-tv-logo-black.png}}

% Load data from CSV file
\DTLloaddb{data}{links.csv}

\begin{document}

\newcommand{\voiaddress}{https://uos-tv.github.io/voi/TV\%20Studio}

% Loop through each row in the data
\DTLforeach{data}{%
  \Location=loc,%
  \Title=pos,%
  \OpGuide=op-guide,%
  \OpRep=op-resp,%
  \TechRef=tech-ref,%
  \Desc=desc%
}{%
  \ifthenelse{\equal{\Location}{PCR}}{\def\LocationName{Production Control Room}}{}
  \ifthenelse{\equal{\Location}{SCR}}{\def\LocationName{Sound Control Room}}{}
  \ifthenelse{\equal{\Location}{VCR}}{\def\LocationName{Vision Control Room}}{}
  \ifthenelse{\equal{\Location}{STD}}{\def\LocationName{Studio Floor}}{}

  % Define page style
  \fancypagestyle{myfancy}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyhead[L]{\leftlogo}
    \fancyhead[R]{\rightlogo}
    \fancyfoot[c]{\LocationName}
  }

  % Apply custom page style
  \pagestyle{myfancy}

  \section*{\centering \Title}
  \begin{center}
    \begin{minipage}[t]{0.45\textwidth}
      \begin{center}
        \textbf{\large Operational\\ Guide(s)} \\[1em]
        \ifx\OpGuide\empty
          N/A
        \else
          \qrcode[version=5,height=1.5in]{\voiaddress/op-guide/\#\OpGuide} \\
        \fi
      \end{center}
    \end{minipage}%
    \hspace{0.05\textwidth}%
    \begin{minipage}[t]{0.45\textwidth}
      \begin{center}
        \textbf{\large Operational\\ Responsibilities} \\[1em]
        \ifx\OpRep\empty
          N/A
        \else
          \qrcode[version=5,height=1.5in]{\voiaddress/op-resp/\#\OpRep} \\
        \fi
      \end{center}
    \end{minipage}

    \vspace{1em}

    \begin{minipage}[t]{0.45\textwidth}
      \begin{center}
        \textbf{\large Technical\\ Reference} \\[1em]
        \ifx\TechRef\empty
          N/A
        \else
          \qrcode[version=5,height=1.5in]{\voiaddress/tech-ref/\#\TechRef} \\
        \fi
      \end{center}
    \end{minipage}%
    \hspace{0.05\textwidth}%
    \begin{minipage}[t]{0.45\textwidth}
      \begin{center}
        \textbf{\large Description \\ ~} \\[1em]
        \ifx\Desc\empty
        \else
          \begin{flushleft}
            \Desc \\
          \end{flushleft}
        \fi
      \end{center}
    \end{minipage}
    \vspace{1em}
  \end{center}
  \newpage % Start a new page for the next item
}

\end{document}
